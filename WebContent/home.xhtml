<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<head>
</head>
<body>
	<ui:composition template="resources/template/layout.xhtml">

		<ui:define name="mainContent">

			<f:view>
				<div class="jumbotron">
					<div class="container">
						<h2>Bienvenue sur votre logiciel collaboratif ICBM !</h2>
						<hr />
						<h4>Vous pouvez consulter ici l'avancement des différents
							WorkPackages.</h4>
					</div>
				</div>

				<div class="container">
					<div class="row">
						<c:set var="nbStart" value="0" />
						<c:set var="nbCreate" value="0" />
						<c:set var="nbInProgress" value="0" />
						<c:set var="nbDone" value="0" />
						<div class="col-md-5">
							<h3>WorkPackages</h3>
							<hr />
							<div class="row">

								<c:forEach items="${workPackageDAO.findAll()}" var="wp">
									<div class="col-md-12">

										<dl>
											<c:if test="${workPackageDAO.findAll().size() eq 0}">
												<dt>Pas de WorkPackage à afficher.</dt>
											</c:if>
											<dt>
												<h:outputText value="${wp.name}"></h:outputText>
											</dt>
											<dt>
												<h:outputText value="Statut : ${wp.status}"
													style="font-weight: normal;"></h:outputText>
												<c:choose>
													<c:when test="${wp.status eq 'Start'}">
														<c:set var="nbStart" value="${nbStart + 1}" />
													</c:when>
													<c:when test="${wp.status eq 'Create'}">
														<c:set var="nbCreate" value="${nbCreate + 1}" />
													</c:when>
													<c:when test="${wp.status eq 'InProgress'}">
														<c:set var="nbInProgress" value="${nbInProgress + 1}" />
													</c:when>
													<c:when test="${wp.status eq 'Done'}">
														<c:set var="nbDone" value="${nbDone + 1}" />
													</c:when>
												</c:choose>
											</dt>
										</dl>
									</div>
								</c:forEach>

							</div>
						</div>
						<div class="col-md-7">
							<h4>Etat actuel des différents workPackages</h4>
							<div class="row">
								<div id="wpChartDiv">
									<canvas id="wpChart" width="300" height="200"></canvas>
								</div>
							</div>
						</div>
						<input id="nbStart" value="${nbStart}" type="hidden" /> <input
							id="nbCreate" value="${nbCreate}" type="hidden" /> <input
							id="nbInProgress" value="${nbInProgress}" type="hidden" /> <input
							id="nbDone" value="${nbDone}" type="hidden" />
						<script type="text/javascript" src="resources/js/barChart.js"></script>
					</div>
				</div>

			</f:view>

		</ui:define>


	</ui:composition>
</body>
</html>